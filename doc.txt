Link to setup RPi k8s cluster: https://www.youtube.com/watch?v=B2wAJ5FLOYw

DB Schema
---------

1. Create database:
Query:
    CREATE DATABASE dbSL

2. tblCategory    
Columns:
    a. cid: Int, Unique, Primary
    b. name: String
    d. active: bool
Query:
    CREATE TABLE tblCategory (
        cid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        name VARCHAR(50) NOT NULL,
        active BOOLEAN NOT NULL DEFAULT True
    )
Endpoints:
    a. POST <BASE_URL>/v1/categories - Insert new category
    b. GET <BASE_URL>/v1/categories - Get all categories    
    c. GET <BASE_URL>/v1/categories/{cid} - Get category
    d. PUT <BASE_URL>/v1/categories/{cid} - Update category
    e. DELETE <BASE_URL>/v1/categories/{cid} - Delete category

2. tblChannel
Columns:
    a. chid: Int, Unique, Primary
    b. name: String
    c. logo: String
    d. cid: Int
    e. active: bool
Query:
    CREATE TABLE tblChannel (
        chid INT(6) UNSIGNED PRIMARY KEY,
        name VARCHAR(50) NOT NULL,
        logo VARCHAR(150) NOT NULL,
        cid INT(6),
        active BOOLEAN NOT NULL DEFAULT True
    )
Endpoints:
    a. POST <BASE_URL>/v1/channels - Insert new channel 
    b. GET <BASE_URL>/v1/channels - Get all channels
    c. GET <BASE_URL>/v1/channels/category/{cid} - Get all channels belongs to category
    d. GET <BASE_URL>/v1/channels/{chid}/number - Get channel by number
    e. GET <BASE_URL>/v1/channels/{name}/name - Get channel by name    
    f. PUT <BASE_URL>/v1/channels/{chid} - Update channel
    g. DELETE <BASE_URL>/v1/channels/{chid} - Delete channel

3. tblCommand
Columns:
    a. id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    a. cid: String,
    b. key: String,
    c. active: bool
Query:
    CREATE TABLE tblCommand (
        id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
        cid VARCHAR(10) NOT NULL,
        `key` VARCHAR(10) NOT NULL,
        active BOOLEAN NOT NULL DEFAULT True
    )
Endpoints:
    a. POST <BASE_URL>/v1/commands - Insert new command 
    b. GET <BASE_URL>/v1/commands - Get all commands    
    c. GET <BASE_URL>/v1/commands/{cid}/cid - Get command by id
    d. GET <BASE_URL>/v1/commands/{key}/key - Get command by key    
    e. PUT <BASE_URL>/v1/channels/{cid} - Update command
    f. DELETE <BASE_URL>/v1/channels/{cid} - Delete command

4. Publish command
{
    "topic": "/cbr/fan1",
    "msg": [
        {
            "cmd": "ON",
            "cron": "30 23 * * *"
        },
        {
            "cmd": "OFF",
            "cron": "30 6 * * *"
        }
    ]
}

Docker xbuild:
docker buildx build --push --platform linux/arm/v7 --tag rsharnagate/sl-rest:lts-alpine3.9 .

MySQL details
----------------
PUID:                 1000
PGID:                 1000
TZ:                   Asia/Calcutta
MYSQL_ROOT_PASSWORD:  my-root-password
MYSQL_DATABASE:       dbSL
MYSQL_USER:           my-user
MYSQL_PASSWORD:       my-password

---------------------------------------

kubectl run -i --tty --rm debug --image=busybox --restart=Never -- sh

---------------------------------------
Create private registry credential

kubectl create secret docker-registry regcred --docker-server=https://index.docker.io/v1/ --docker-username=rsharnagate --docker-password=Sam123456#$ --docker-email=rakesh.sharnagate@gmail.com

-----------------------------
Get bash

kubectl exec -t -i nginx-78f5d695bd-czm8z bash

